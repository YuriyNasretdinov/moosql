#summary The MooSQL HOWTO article describing the current available API
#labels Featured

= Introduction =

The MooSQL is a project which has the intention to build an RDBMS in pure PHP with support of MySQL syntax for queries and which would have relatively high performance on big data sets.


= Details =

== 1. What API is available at the moment? ==

MooSQL now only supports the core API, primarily YNDb.

It supports `create()` / `select()` / `insert()` and `update()` methods which allow you to create new tables, perform simple select queries from tables, insert data into the table and update contents of existing rows with only limitation that you cannot increase length of text fields.

YNDb supports indexed and auto-incremented fields with ability to have UNIQUE indexes as well. Text fields cannot be indexed at the moment.

== 2. How do I begin to work with MooSQL? ==

First, do `svn checkout` of the latest version from `/trunk` to some directory, e.g. `moosql`.

Then, in your PHP script, include `moosql/Client.php` and create new YNDb instance:

{{{
<?php
include 'moosql/Client.php';

$MOO = new YNDb('data_directory');
...
}}}

The *_data_directory_* is the directory where MooSQL will store its' data. This directory must be readable and writable for a PHP script. Also it is recommended to deny web access to this directory either by placing it outside DocumentRoot or by placing .htaccess file with the following contents (Apache with enabled AllowOverride only):

{{{
deny from all
}}}

== 3. Creating tables ===

To create table, call `$MOO->create(string $name, array $fields, array $params)` method, with the following format for parameres:

*$name:*

Table name. Table name is directly translated to file names, so it can be case-sensitive if the server filesystem is.

*$fields:*
{{{
array(
	'keyname1' => 'type1',
	...,
	'keynameN' => 'typeN',
);
}}}

|| keyname,,i,, || name of your table column ||
|| type,,i,,|| one of the types below||


=== Table 1. Column types ===


|| BYTE || 8-bit  integer ( from -128           to 127           ) ||
|| INT  || 32-bit integer ( from -2 147 483 648 to 2 147 483 647 ) ||
|| TINYTEXT || string with length less than 256 characters ||
|| TEXT || string with length less than 65 536 characters ||
|| LONGTEXT || string with length less than YNDb::MAXLEN (default 1 Mb) characters ||
|| DOUBLE || a number with floating point ||

*$params:*
{{{
array(
	'AUTO_INCREMENT' => 'autofield',
	['UNIQUE'        => array('uniquefield1', ..., 'uniquefieldN'), ]
	['INDEX'         => array('indexfield1',  ..., 'indexfieldN'), ]
);
}}}

|| autofield || name of AUTO_INCREMENT field. Must be INT. Note, that AUTO_INCREMENT field is considered as PRIMARY INDEX, and MUST BE SET in every table ||
|| uniquefield,,i,, || name of field with UNIQUE index. Must be BYTE, INT or DOUBLE. Such field has only distinct values. ||
|| indexfield,,i,, || name of field with INDEX. Must be BYTE, INT or DOUBLE. Works like UNIQUE, but coincident values are allowed. ||

== 4. Inserting values into a table ==

To insert a row, call `$MOO->insert(string $name, array $data)` with the following parameters:

*$name:* Table name.

*$data:*

{{{
array(
	['field1' => 'value1',]
	...,
	['fieldN' => 'valueN']
);
}}}

|| field,,i,, || Column name ||
|| value,,i,, || Value for corresponding column ||

Value for AUTO_INCREMENT column can be supplied in case you want to insert a row with ID which has been previously deleted. Arbitrary values for AUTO_INCREMENT column are not supported, use UNIQUE index for that purpose.

You can skip fields so that they get the default value (0 for integer/double types, empty string for text types). NULL values are not currently supported.